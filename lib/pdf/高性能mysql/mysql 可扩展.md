
## 扩展

增加资源以处理负载和增加容量的投入产出
- 向上扩展,增加硬件配置
- 向外扩展,主要分为: 复制,拆分,数据分片
	1. 复制将数据分发到多台服务器上,将备库用于查询
	2. 将工作负载均衡到不同的服务器
	3. 按照对应功能进行拆分,OLAP 和OLTP
- 多实例扩展,注意的是mysql并不能完全发挥硬件性能,当cpu超过24核心数/内存超过128g时,mysql性能提升缓慢
- 集群扩展
	1. mysql cluster(非自己搭的集群): 复杂查询支持不是很好,不支持mvcc
- 向内扩展,数据归档,可以做为短期的策略
	1. 归档和清理
		1. 应用的影响,平衡事务和归档行数的大小,以免过多的锁竞争
		2. 对需要归档的行的及时处理,转移到其他表或者服务器
		3. 保证数据一致性
		4. 避免数据的丢失
	2. 保持活跃数据的独立性
		1. 冷热数据表
		2. 基于时间分区,动态分片

### 负载均衡

#### 常见目的:
1. 可扩展性
2. 高效性
3. 可用性 在一个架构中部署多套故障转移机制
4. 透明性
5. 一致性

#### 常见方式:

1. 直接连接
	1. 读写分离,如果使用可能由于脏数据导致一些问题,常见分离方式有:
		- 基于查询的读写(没有避免该问题),
		- 基于脏数据的分离(让应用检查复制延迟),
		- 基于会话分离(用户在一段时间内总是查询主库)
		- 基于版本分离 从备库获取版本判断是否够新,顶层对象下面任何对象有变化都增加版本号,简化了脏数据检查.
2. 中间件
	 1. 负载均衡器
			连接池和长链接,实际负载情况未知,服务器的健康检查		
	 2. 负载均衡算法
			随机,轮训,最少连接数,最快响应,哈希,权重
3. 一主多备
	  - 功能区分:报表,数分,数仓等功能
	  - 过滤和数据分区,在主库上就隔离到了不同的数据库表中
	  - 将部分写转移到备库.保证备库跟上主库	  
		
		
		
		
