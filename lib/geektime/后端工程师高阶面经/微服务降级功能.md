---
dg-publish: true
title: 微服务降级功能
createTime: 2023-06-23 23:16  
---

熔断、降级、限流是三个经常合并在一起讨论的可用性保障措施

## 降级对应策略

- 如何判定服务健康，在降级中则是判定一个服务要不要降级。
- 降级之后怎么恢复，也是要考虑抖动的问题。

应该优先考虑使用降级的。然而有些服务是无法降级的，尤其是写服务。例如你从前端接收数据，然后写到数据库，这种场景是无法降级的。另外，如果你希望系统负载尽快降低，那么熔断要优于降级。

## 如何降级？

1. 跨服务降级。当资源不够的时候，可以暂停某些服务，将腾出来的资源给其他更加重要、更加核心的服务使用。我这里提到的大促暂停退款服务就是跨服务降级的例子。这种策略的要点是必须知道一个服务比另外一个服务更有业务价值，或者更加重要。
2. 本服务提供有损服务。例如各大 App 的首页都会有降级的策略。在没有触发降级的时候，App 首页是针对你个人用户画像的个性化推荐。而在触发了降级之后，则可能是使用榜单数据，或者使用一个运营提前配置好的静态页面。这种策略的要点是你得知道你的服务调用者能够接受什么程度的有损。

### 常见的做法有三个

- 整个服务停掉，例如前面提到的停掉退款服务。
- 停掉服务的部分节点，例如十个节点，停掉其中五个节点，这五个节点被挪作他用。
- 停止访问某些资源。例如日志中心压力很大的时候，发信号给某些不重要的服务，让它们停止上传日志，只在本地保存日志。
