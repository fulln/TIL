---
dg-publish: true
---

#java #极客时间 #设计思想 

# 商品搜索系统

### 理解倒排索引机制

搜索的核心需求是全文匹配

为了能够支持快速地全文搜索，ES 中对于文本采用了一种特殊的索引：倒排索引（Inverted Index）。

搜索过程，其实就是对上面的倒排索引做了二次查找，一次找“苹果”，一次找“手机”。注意，整个搜索过程中，我们没有做过任何文本的模糊匹配。ES 的存储引擎存储倒排索引时，肯定不是像我们上面表格中展示那样存成一个二维表，实际上它的物理存储结构和 MySQL 的 InnoDB 的索引是差不多的，都是一颗查找树。

### 如何在 ES 中构建商品的索引?

在 ES 里面，数据的逻辑结构类似于 MongoDB，每条数据称为一个 DOCUMENT，简称 DOC。DOC 就是一个 JSON 对象，DOC 中的每个 JSON 字段，在 ES 中称为 FIELD，把一组具有相同字段的 DOC 存放在一起，存放它们的逻辑容器叫 INDEX，这些 DOC 的 JSON 结构称为 MAPPING。这里面最不好理解的就是这个 INDEX，它实际上类似于 MySQL 中表的概念，而不是我们通常理解的用于查找数据的索引。

让 ES 支持中文分词，需要给 ES 安装一个中文的分词插件IK Analysis for Elasticsearch，这个插件的作用就是告诉 ES 怎么对中文文本进行分词。·

```shell
$elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.0/elasticsearch-analysis-ik-7.6.0.zip
```

# 地址

此文章为3月day25 学习笔记，内容来源于极客时间《[03 | 复杂而又重要的购物车系统，应该如何设计？ (geekbang.org)](https://time.geekbang.org/column/article/206061)》，《[04 | 事务：账户余额总是对不上账，怎么办？ (geekbang.org)](https://time.geekbang.org/column/article/206544)》