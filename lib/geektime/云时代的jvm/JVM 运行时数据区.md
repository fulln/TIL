---
dg-publish: true
title: 工作台：JVM 运行时数据区的内部机制是怎样的？
createTime: 2023-08-25 23:34  
---
# 工作台：JVM 运行时数据区的内部机制是怎样的？
![](https://static001.geekbang.org/resource/image/2c/39/2c18969c0cbf8dd84f3be6fbfa421939.png?wh=1920x890)

### 存储内容

在局部变量表中，retureAddress 指向字节码指令，reference 则指向堆内存里的对象，8 种基本数据类型包括 boolean、byte、char、short、int、long、float 和 double，它们构成了一个完整的局部变量表，可以满足多种需求。

#### 两大特性

1. 容量确定性
把 Java 程序编译为 Class 文件的过程中，局部变量表的大小已经被精确地设置好了，并且这个值被存储在方法 Code 属性的 max_locals 字段里。因此每次调用一个方法，它对应的局部变量表的大小是确定的，并且在运行期间也不会调整。
2. 复用性
局部变量表里的变量槽可以被多次重复使用。比如函数里一个循环内的局部变量，它的作用域只在当前循环中，这时候后面的变量可以占用这个变量的 slot。

> JVM 使用局部变量表来存储方法中的局部变量以及方法参数，这些局部变量表槽位的替代性允许在不同阶段使用相同的槽位来存储不同的变量，从而提高内存的利用效率
#### 其他用途
局部变量表是 GC Root 的一部分，当 slot 里存放的数据类型是 reference 的时候，它关联的对象就是 GC 里的 “可达对象”。关于 JVM 定位可达对象的详细信息，

### 动态链接（Dynamic Linking）
在类文件的常量池里，含有大量的符号引用，这些都是方法调用指令的参数，这些参数在字节码中表现为指向方法的符号引用。无论是在类加载的阶段还是第一次使用的时候，一部分符号引用会被转换为直接引用，这种转换过程被我们叫做静态解析。另一部分符号引用则会在每次运行时都转化为直接引用，也就是所谓的动态链接。

## 主要方向

要尽可能地减小每个变量的作用域，为虚拟机提供了更多的可能性去优化局部变量表，重用槽位，从而减少了内存占用。知己知彼，百战不殆，越熟悉每天陪伴我们的工具，越有利于我们写出更优雅的 Java 程序

# 地址

此文章为8月day25 学习笔记，内容来源于极客时间《https://time.geekbang.org/column/article/690294》