---
dg-publish: true
title: netty 常见2次编码解码方式
createTime: 2023-10-18 23:35
tags:
  - netty
---
## 为啥需要2次编解码

1. 除了可选的压缩解压缩外， 需要一层解码，因为1次解码是字节，需要和项目中对象转换，方便使用。对应解码器是为了将java对象转成字节流存储或者传输
![[attachment/Pasted image 20231018233748.png]]

### 一次解码器  ByteToMessageDecoder

原始数据 -> 用户数据
### 二次解码器 MessageToMessageDecoder<\i\>

用户数据 -> JAVA对象

### 可以合并1次解码（粘包，半包）和2次解码（可操作问题）么？

不建议，1. 没有分层，2耦合性高

## 常用的2次解码方式

java序列化，Marshaling，xml，json，messagePack，Protobuf等

### 选择编解码方式的要点

1. 空间：编码后占用空间
2. 时间：编解码速度
3. 可读性
4. 多语言支持

### protobuf

1. 更小更快更便捷
2. 跨语言，自带编译器，自动生成java等代码

#### 序列化与反序列化
toByteArray/parseFrom






