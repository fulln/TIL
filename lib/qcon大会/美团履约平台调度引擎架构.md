---
dg-publish: true
title: 美团履约平台调度引擎架构
createTime: 2023-05-27 09:21  
---

### 业务背景

#### 业务的定位特点

- 线上+线下履约过程的最后一环
- 保障商家，用户，骑士的体验
- 时效性强
- 稳定性要求极高

#### 调度业务:
	1. 对接多端，承接配送业务
	2. 通过调度策略，将运单转换成运力承接的配送任务
	3. 体验，人效，成本的平衡

##### 主要职责：
1. 数据召回,打分
2. 匹配程度,路径规划(cpu集群)

### 业务增长下的挑战

#### 数据召回:
- 串行召回,由业务决定.
	- 单次调度耗时高
	- 重复召回请求数量上升
		- 增加下游机器成本

优化:
1. 实时数据
	1. 可以水平拆分
	2. 业务数据变化频繁,对数据变化敏感
2. 离线数据
	1. TB级别数据
	2. 难拆分
	3. 数据按照天维度更新,

实时数据思路落地:
1. 全量:
	1. 实现简单
2. 分片
	1. 有状态服务,实现复杂
	2. 同步开销小

有状态服务:

1. 容量稳定侧,路由需要额外成本
	1. 做更细粒度容量管理
2. 状态重建难度,需要缩短
	1. 发布
		1. 恢复状态,降低影响
	2. 弹性伸缩
		1. 状态迁移,使用数据快照
3. 状态存储溢出
	1. 设置内存容量上限,超过只落磁盘
	2. 牺牲读,降级读磁盘
	3. 分片迁移其他副本
	4. 自动恢复
4. 数据一致性
	1. 实时同步
	2. 分钟级检查修复
		1. 补数据
		2. 告警,检查问题产生原因

离线数据思路落地:

lBS: 点对点导航
- TB 级别数据
- 难拆分
- 数据天更细


### 业务增长下的挑战

1. 成本问题
2. 随着核数增加,计算效率面临降低风险
3. RPC通讯长尾


### 解决问题的实践

### 总结

