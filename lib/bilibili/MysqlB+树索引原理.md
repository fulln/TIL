---
dg-publish: true
---

#mysql #算法 

## 请描述MySQL的B+树索引原理，B+树索引有哪些好处

视频地址: [头条面试：请描述MySQL的B+树索引原理，B+树索引有哪些好处_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1yM411s7WV/?spm_id_from=444.41.list.card_archive.click&vd_source=1690412baac5d9ecc946844006611737)

### 磁盘类型存储的区别

#### HDD
会划分为大小为512b的扇区
#### SSD 硬盘
没有扇区定义，而是由4kb的 page 页组成

### HDD下对应关系

如果刚刚好是512B 一条数据，则为32个扇区，而操作系统会有缓存数据和连续读的概念:

当一个数据被用到时，通常附近的数据也会被用到，因此文件系统会把一个块大小设置为了4KB，所以一次IO操作会加载8个扇区的数据到内存

因此，一个文件内容虽然只有1个字符串，但是整个文件实际大小是占用了4kb的

mysql最小存储单元是页，一个页的占用内存默认为16kb，每次IO都会缓存16kb。

因此放到bufferPool中也是16kb，每个byteBuffer大小也是16kb，因此释放时不用等待JVM的GC，也就不会发生stop-the-world 

所以在刚好是单页情况下，有没有索引都不会感觉到性能的差异，这就是**顺序读**和**bufferPool** 带来的性能提升

mysql 中所有数据都是存放在page上，即使非常小的一张表都会占用整数倍page

| 类型       | 大小 |
| ---------- | ---- |
| InnoDb的页 |  16KB     |
| 块         |  4kb    |
| 磁盘扇区           | 512b     |

mysql 加载数据时，在HDD中发生32次io顺序读，在SSD中发生4次IO顺序读。

### B+树索引

记录条数:
一个page(16KB) / 每条记录大小（假设512b） = 32条
索引条数：
一个page(16KB) / 【key大小（8b）+ 指针(6b)】 = 1170条

是一种用空间换时间的做法
