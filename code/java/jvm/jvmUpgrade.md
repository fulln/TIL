---
dg-publish: true
---

#java #jvm 
## JVM调优与GC

### 常用工具介绍

jstat 查看虚拟机运行状况，如看GC（-gc）看类加载（-class）看编译（-compiler）
jmap 根据对象的class 看占用内存大小和实例数量，如果出现某个类异常占用内存过多
jstack 打印线程执行状态

### 如何定位垃圾

可达性分析

### 常用垃圾回收算法

CMS 老年代GC + PALLAR NEW年轻代
G1 性能消耗比较大
ZGC (只能管理4TB以内的内存)和 SHENANDOAH 次世代低延迟gc， 

### 系统上线前预估系统的内存占用情况

根据单行数量和最大查询size（导出） 来判断最大的对象的内存占用会有多少,然后根据QPS和TPS 来判断当前可能达到的内存最大值。
然后根据这个值去调最大内存与可用内存

### 根据预估值设定JVM初始参数

### 根据压测结果调整参数值

根据QPS 和内存占用比来确定最终的xms 和xmx

### 根据日志解决实战问题



