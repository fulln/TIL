---
createTime: 2024-03-04 11:40
tags:
  - mysql
  - index
---
## 常见的索引模型
1.  hash
	  - 冲突后使用链表处理
	  - 优缺点
			- 新增很快
			- 区间查询速度慢
			- 等值查询速度快
 2.  有序数组
	  - 优缺点
			- 查询都很快
			- 更新数据成本高
	  - 只适用静态存储引擎
 - 搜索树
	  - N叉搜索树
		- 根据数据块大小来决定,整数型默认是1200
			 - MySql默认一个节点的长度为16K，一个整数（bigint）字段索引的长度为 8B,另外每个索引还跟着6B的指向其子树的指针；所以16K/14B ≈ 1170
			 - 第二层大概 1200页，所以 1200 * 16KB = 20M，内存还是放得下的。第三层大概144W页，要144w * 16kB =23G, 都放内存就不合适了。
	  - 优缺点
		- 读写性能优异
			 - 读写空间复杂度为O(nlogn)
		- 适配磁盘的访问模式
 - 其他新型模型
	  - 跳表
		- redis
	  - lsm树
		- kv引擎数据库

## 基础原则  
  - 索引要限制条数
	- 不是说越多越好, 索引过多会导致当前进行增删改操作的时候会消耗比较大
  - 尽量的扩展原来的索引而不是写新的索引
  - 索引长度不能过长,InnoDb引擎下索引长度不能超过767byte
  - 使用索引前缀值进行查询
  - = 和 in 可以乱序(=中包含了范围索引后这个规则将无效,也就是说当使用了时间字段做索引的时候,最好时间字段放在最后
  - 删除不再使用的索引
  - 索引列不要参与计算(索引的字段名字不要放到函数中)
  - 索引的唯一性
	- 可以创建唯一索引加快查询速度
  - 最左原则
	- 设置索引是根据最左匹配原则进行匹配
	- group by 和 order by 都要通过这个原则
## 分类
 - 非主键索引（树的时候是在叶子结点的val值里存主键，然后通过回表的方式定位到具体行所在的位置
	  - 在创建非唯一键索引的b+树的时候可能会在目录树上加一个主键作为唯一区分
		- 所以可以加上一个主键的条件判断进行sql的优化
- 聚簇索引
	- 规则
		- 1.根据主键查询的时候，不用回行（数据就在主键节点下
		- 2.如果遇到不规则数据插入，会导致频繁页分裂
	- 优缺点
		- 1.数据访问更快，因为聚簇索引将索引和数据保存在同一个B+树中，因此从聚簇索引中获取数据比非聚簇索引更快
		- 2.聚簇索引对于主键的排序查找和范围查找速度非常快
		- 3.插入速度严重依赖于插入顺序，按照主键的顺序插入是最快的方式，否则将会出现页分裂，严重影响性能。因此，对于InnoDB表，我们一般都会定义一个自增的ID列为主键
		- 4.更新主键的代价很高，因为将会导致被更新的行移动。因此，对于InnoDB表，我们一般定义主键为不可更新。
		- 5.二级索引访问需要两次索引查找，第一次找到主键值，第二次根据主键值找到行数据
