---
dg-publish: true
title: Map中为啥使用红黑树而不使用平衡二叉树
createTime: 2024-03-03 18:41
tags:
  - java
  - javabasic
  - 红黑树
  - datastruct
  - avlTree
---
## HashMap中红黑树结构(TreeNode)
- node的基础上加了左右Node,和一个颜色的布尔标记值
- 在当前链长度超过8之后,会进行红黑树的转换
- 默认树化的阈值8			  
	- 满足一个泊松分布的数学计算模型, 当这个默认值为8时,hash碰撞的概率大大减少,大概为1/1亿
- 属性和规则
	- 根节点必须为黑色
	- 叶子节点必须为黑色
	- 从根节点出发到任意叶子节点,经过的黑色节点的数量一致
	- 红色的节点后面必须接黑色节点
- 在hashmap中所有新添加的节点颜色都是红色(空叶子节点可以表黑色

## 对比AVLTREE

黑树和平衡二叉树（AVL树）都是自平衡的二叉查找树，它们都可以保证在插入和删除操作后，树的高度保持在O(log n)的范围内，从而保证了查找、插入和删除操作的高效性。然而，红黑树和AVL树在平衡性和操作复杂性上有所不同，这导致了它们在不同的场景下有不同的应用。

1. **平衡性**：AVL树是严格平衡的，它要求任何节点的两个子树的高度差最多为1，而红黑树的平衡性要求较为宽松，它只要求任何节点到其任何后代叶节点的每一条路径上包含相同数量的黑节点。

2. **操作复杂性**：由于AVL树的平衡性要求更严格，因此在插入和删除操作后，需要通过旋转操作来恢复平衡，这可能涉及到多次旋转，而红黑树在插入和删除操作后恢复平衡的复杂性要低一些。

3. **查找、插入和删除操作的效率**：由于AVL树更加平衡，因此在查找操作上，AVL树的效率要高于红黑树。然而，由于红黑树在插入和删除操作后恢复平衡的复杂性较低，因此在插入和删除操作上，红黑树的效率要高于AVL树。

因此，如果你的应用中查找操作更频繁，那么AVL树可能是更好的选择。如果你的应用中插入和删除操作更频繁，那么红黑树可能是更好的选择。在Java的HashMap和TreeMap中，就选择了红黑树作为其内部的数据结构。